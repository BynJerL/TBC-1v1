<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TBC 1v1</title>
    <link rel="stylesheet" href="./style.css">
</head>
<body>
    <div id="game-container">
        <div id="top-bar">
            <div id="turn-queue">
                <div class="turn-item">Hero</div>
                <div class="turn-item">Enemy</div>
            </div>
        </div>
        <div id="center-bar">
            <div id="player-sprite">
                <div class="sprite-image"></div>
                <div class="fighter-stats" id="player-stats">
                    <div class="fighter-name">Hero</div>
                    <div class="fighter-hp">
                        <div class="hp-icon">&hearts;</div>
                        <div class="hp-bar">
                            <div class="hp-fill"></div>
                            <div class="hp-value">100/100</div>
                        </div>
                        
                    </div>
                    <div class="fighter-sp">
                        <div class="sp-icon">&diamondsuit;</div>
                        <div class="sp-bar">
                            <div class="sp-fill"></div>
                            <div class="sp-value">20/20</div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="enemy-sprite">
                <div class="sprite-image"></div>
                <div class="fighter-stats" id="enemy-stats">
                    <div class="fighter-name">Enemy</div>
                    <div class="fighter-hp">
                        <div class="hp-bar">
                            <div class="hp-fill"></div>
                            <div class="hp-value">100/100</div>
                        </div>
                        <div class="hp-icon">&hearts;</div>
                    </div>
                    <div class="fighter-sp">
                        <div class="sp-bar">
                            <div class="sp-fill"></div>
                            <div class="sp-value">20/20</div>
                        </div>
                        <div class="sp-icon">&diamondsuit;</div>
                    </div>
                </div>
            </div>
        </div>
        <div id="bottom-bar">
            <div id="action-info">
                <div id="action-text">Choose your action.</div>
                <button id="next-button"></button>
            </div>
            <div id="action-bar">
                <button id="attack-button" title="">
                    <div class="action-icon">&spades;</div>
                    <div class="action-name">Attack</div>
                </button>
                <button id="defend-button" title=""> 
                    <div class="action-icon">&#x265c;</div>
                    <div class="action-name">Defend</div>
                </button>
                <button id="special-button" title="">
                    <div class="action-icon">&#x2726;</div>
                    <div class="action-name">Special</div>
                </button>
                <button class="check-stats-button" title="">
                    <div class="action-icon">&#x1f441;</div>
                    <div class="action-name">Stats</div>
                </button>
            </div>
        </div>
    </div>
    <script type="module" src="./main.js"></script>
    <script>
        var selectedAction = null;
        var actionTimeoutId = null;

        function disableButtons() {
            document.querySelectorAll('#action-bar button').forEach(button => {
                button.disabled = true;
                button.classList.add('disabled');
                button.attributes['title'].value = `Cannot use "${button.querySelector(".action-name").textContent}" now.`;
            });
        }

        function enableButtons() {
            document.querySelectorAll('#action-bar button').forEach(button => {
                button.disabled = false;
                button.classList.remove('disabled');
                button.attributes['title'].value = '';
            });
        }

        // Add event listeners for buttons
        document.getElementById('attack-button').addEventListener('click', () => {
            console.log('Attack button clicked');

            if (selectedAction !== 'attack') {
                selectedAction = 'attack';
                document.getElementById('action-text').textContent = 'You have clicked attack button. Click again to proceed.';
                
                if (actionTimeoutId) {
                    clearTimeout(actionTimeoutId);
                }
                
                actionTimeoutId = setTimeout(() => {
                    if (selectedAction === 'attack') {
                        document.getElementById('action-text').textContent = 'Choose your action.';
                        selectedAction = null;
                    }
                    actionTimeoutId = null;
                }, 5000);
                return;
            }

            if (selectedAction === 'attack') {
                document.getElementById('action-text').textContent = 'You attacked the enemy!';
                selectedAction = null;
                disableButtons();
                document.getElementById('next-button').style.display = 'block';

                if (actionTimeoutId) {
                    clearTimeout(actionTimeoutId);
                    actionTimeoutId = null;
                }
            }
        });

        document.getElementById('defend-button').addEventListener('click', () => {
            console.log('Defend button clicked');

            if (selectedAction !== 'defend') {
                selectedAction = 'defend';
                document.getElementById('action-text').textContent = 'You have clicked defend button. Click again to proceed.';
                
                if (actionTimeoutId) {
                    clearTimeout(actionTimeoutId);
                }
                
                actionTimeoutId = setTimeout(() => {
                    if (selectedAction === 'defend') {
                        document.getElementById('action-text').textContent = 'Choose your action.';
                        selectedAction = null;
                    }
                    actionTimeoutId = null;
                }, 5000);
                return;
            }

            if (selectedAction === 'defend') {
                document.getElementById('action-text').textContent = 'You defended yourself against the enemy attack!';
                selectedAction = null;
                disableButtons();
                document.getElementById('next-button').style.display = 'block';

                if (actionTimeoutId) {
                    clearTimeout(actionTimeoutId);
                    actionTimeoutId = null;
                }
            }
        });

        document.getElementById('special-button').addEventListener('click', () => {
            console.log('Special button clicked');
            document.getElementById('action-text').textContent = 'You chose to use special!';
        });

        document.querySelector('.check-stats-button').addEventListener('click', () => {
            console.log('Check stats button clicked');
            document.getElementById('action-text').textContent = 'You chose to check your stats!';
        });

        document.getElementById('next-button').addEventListener('click', () => {
            console.log('Next button clicked');
            enableButtons();
            document.getElementById('next-button').style.display = 'none';
            document.getElementById('action-text').textContent = 'Choose your action.';
        });
    </script>
</body>
</html>